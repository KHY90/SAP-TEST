sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/Device","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/m/Menu","sap/m/MenuItem","sap/m/MessageToast","sap/ui/core/Fragment","./Formatter"],function(e,t,i,n,o,s,r,a,u,l){"use strict";var g=e.extend("ui5.walkthrough.TableViewSettingsDialog.SettingsDialogController",{formatter:l,onInit:function(){var e=this.getView();u.load({id:this.getView().getId(),name:"ui5.walkthrough.TableViewSettingsDialog.ColumnMenu",controller:this}).then(function(t){e.addDependent(t);return t});this._mViewSettingsDialogs={};var t=new o(sap.ui.require.toUrl("sap/ui/demo/mock/products.json"));this.getView().setModel(t);this.mGroupFunctions={SupplierName:function(e){var t=e.getProperty("SupplierName");return{key:t,text:t}},Price:function(e){var t=e.getProperty("Price");var i=e.getProperty("CurrencyCode");var n,o;if(t<=100){n="LE100";o="100 "+i+" or less"}else if(t<=1e3){n="BT100-1000";o="Between 100 and 1000 "+i}else{n="GT1000";o="More than 1000 "+i}return{key:n,text:o}}}},resetGroupDialog:function(e){this.groupReset=true},getViewSettingsDialog:function(e){var i=this._mViewSettingsDialogs[e];if(!i){i=u.load({id:this.getView().getId(),name:e,controller:this}).then(function(e){if(t.system.desktop){e.addStyleClass("sapUiSizeCompact")}return e});this._mViewSettingsDialogs[e]=i}return i},handleSortButtonPressed:function(){this.getViewSettingsDialog("sui5.walkthrough.TableViewSettingsDialog.SortDialog").then(function(e){e.open()})},handleFilterButtonPressed:function(){this.getViewSettingsDialog("ui5.walkthrough.TableViewSettingsDialog.FilterDialog").then(function(e){e.open()})},handleGroupButtonPressed:function(){this.getViewSettingsDialog("ui5.walkthrough.TableViewSettingsDialog.GroupDialog").then(function(e){e.open()})},handleSortDialogConfirm:function(e){var t=this.byId("idProductsTable"),i=e.getParameters(),o=t.getBinding("items"),s,r,a=[];s=i.sortItem.getKey();r=i.sortDescending;a.push(new n(s,r));o.sort(a)},handleFilterDialogConfirm:function(e){var t=this.byId("idProductsTable"),n=e.getParameters(),o=t.getBinding("items"),s=[];n.filterItems.forEach(function(e){var t=e.getKey().split("___"),n=t[0],o=t[1],r=t[2],a=t[3],u=new i(n,o,r,a);s.push(u)});o.filter(s);this.byId("vsdFilterBar").setVisible(s.length>0);this.byId("vsdFilterLabel").setText(n.filterString)},handleGroupDialogConfirm:function(e){var t=this.byId("idProductsTable"),i=e.getParameters(),o=t.getBinding("items"),s,r,a,u=[];if(i.groupItem){s=i.groupItem.getKey();r=i.groupDescending;a=this.mGroupFunctions[s];u.push(new n(s,r,a));o.sort(u)}else if(this.groupReset){o.sort();this.groupReset=false}},onToggleContextMenu:function(e){var t=e.getSource();if(e.getParameter("pressed")){t.setTooltip("Disable Custom Context Menu");this.byId("idProductsTable").setContextMenu(new s({items:[new r({text:"{Name}"}),new r({text:"{ProductId}"})]}))}else{t.setTooltip("Enable Custom Context Menu");this.byId("idProductsTable").destroyContextMenu()}},onActionItemPress:function(){a.show("Action Item Pressed")}});return g});